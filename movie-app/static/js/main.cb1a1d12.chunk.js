(this["webpackJsonpmovie-app"]=this["webpackJsonpmovie-app"]||[]).push([[0],{27:function(e,t,a){e.exports=a(46)},45:function(e,t,a){},46:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(13),l=a.n(c),o=a(3),i=a(10),s=a(2),m=a.n(s),u=a(7),p=a(19),d=a(20),v=a(26),g=a(25),h={base_url:"http://image.tmdb.org/t/p/",secure_base_url:"https://image.tmdb.org/t/p/",backdrop_sizes:["w300","w780","w1280","original"],logo_sizes:["w45","w92","w154","w185","w300","w500","original"],poster_sizes:["w92","w154","w185","w342","w500","w780","original"],profile_sizes:["w45","w185","h632","original"],still_sizes:["w92","w185","w300","original"]},f="a3922856eb59dc0a86a6849412c18182";function E(e){return b.apply(this,arguments)}function b(){return(b=Object(u.a)(m.a.mark((function e(t){var a,n,r,c,l,o,i,s,u,p,d,v,g,E;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="https://api.themoviedb.org/3/movie/".concat(t,"?api_key=").concat(f),e.next=3,fetch(a);case 3:return n=e.sent,r="https://api.themoviedb.org/3/movie/".concat(t,"/videos?api_key=a3922856eb59dc0a86a6849412c18182&language=en-US"),e.next=7,fetch(r);case 7:if(c=e.sent,l="",200!==c.status){e.next=14;break}return e.next=12,c.json();case 12:for(o=e.sent,i=0;i<o.results.length;i++)"Trailer"===o.results[i].type&&"YouTube"===o.results[i].site&&(l=o.results[i].key);case 14:return s=[],u="https://api.themoviedb.org/3/movie/".concat(t,"/similar?api_key=").concat(f,"&language=en-US&page=1"),e.next=18,fetch(u);case 18:if(p=e.sent,200!==c.status){e.next=24;break}return e.next=22,p.json();case 22:d=e.sent,s=d.results.map((function(e){return{id:e.id,title:e.title,poster_path:h.secure_base_url+h.poster_sizes[3]+"/"+e.poster_path}}));case 24:if(200!==n.status){e.next=31;break}return e.next=27,n.json();case 27:return v=e.sent,g=new Date(v.release_date),E={id:v.id,title:v.title,tagline:v.tagline,overview:v.overview,runtime:v.runtime,release_date:g.toDateString().split(" ").slice(1).join(" "),budget:v.budget,revenue:v.revenue,language:v.original_language.toUpperCase(),production_companies:v.production_companies,backdrop_path:h.secure_base_url+h.backdrop_sizes[3]+"/"+v.backdrop_path,poster_path:h.secure_base_url+h.poster_sizes[3]+"/"+v.poster_path,genres:v.genres,rating:v.vote_average,trailer_id:l,similar_movies:s},e.abrupt("return",E);case 31:throw new Error(n.statusText);case 32:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e,t){return k.apply(this,arguments)}function k(){return(k=Object(u.a)(m.a.mark((function e(t,a){var n,r,c,l;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n="",e.t0=t,e.next="p"===e.t0?4:"tr"===e.t0?6:"u"===e.t0?8:10;break;case 4:return n="https://api.themoviedb.org/3/movie/popular?api_key=".concat(f,"&page=").concat(a),e.abrupt("break",12);case 6:return n="https://api.themoviedb.org/3/movie/top_rated?api_key=".concat(f,"&page=").concat(a),e.abrupt("break",12);case 8:return n="https://api.themoviedb.org/3/movie/upcoming?api_key=".concat(f,"&page=").concat(a),e.abrupt("break",12);case 10:return n="https://api.themoviedb.org/3/movie/now_playing?api_key=".concat(f,"&page=").concat(a),e.abrupt("break",12);case 12:return e.next=14,fetch(n);case 14:if(200!==(r=e.sent).status){e.next=21;break}return e.next=18,r.json();case 18:return c=e.sent,l=c.results.map((function(e){return{id:e.id,poster_path:h.secure_base_url+h.poster_sizes[3]+"/"+e.poster_path,title:e.title,overview:e.overview,release_date:e.release_date,genre_ids:e.genre_ids}})),e.abrupt("return",l);case 21:throw new Error(r.statusText);case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(e){return y.apply(this,arguments)}function y(){return(y=Object(u.a)(m.a.mark((function e(t){var a,n,r,c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==t.trim()){e.next=2;break}return e.abrupt("return");case 2:return a="https://api.themoviedb.org/3/search/movie?api_key=".concat(f,"&language=en-US&query=").concat(t,"&page=1"),e.next=5,fetch(a);case 5:if(200!==(n=e.sent).status){e.next=12;break}return e.next=9,n.json();case 9:return r=e.sent,c=r.results.map((function(e){return{id:e.id,title:e.title,poster_path:h.secure_base_url+h.poster_sizes[2]+"/"+e.poster_path,release_date:e.release_date}})),e.abrupt("return",c);case 12:throw new Error(n.statusText);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var O=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"favourites";if(localStorage.getItem(t)){var a=JSON.parse(localStorage.getItem(t));a.push(e),localStorage.setItem(t,JSON.stringify(a))}else{var n=JSON.stringify([e]);localStorage.setItem(t,n)}},_=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"favourites",a=JSON.parse(localStorage.getItem(t)),n=a.findIndex((function(t){return+t.id===+e}));a.splice(n,1),0===a.length?localStorage.removeItem(t):localStorage.setItem(t,JSON.stringify(a))},S=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"favourites";if(!localStorage.getItem(t))return!1;for(var a=JSON.parse(localStorage.getItem(t)),n=0;n<a.length;n++)if(+a[n].id===+e)return!0;return!1},x=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"np";localStorage.setItem(t,JSON.stringify(e))};function j(){var e=new Date;document.cookie="lastfetch="+(e.getTime()+36e5)+";path=/"}function I(){var e=(new Date).getTime(),t=function(e){for(var t=e+"=",a=document.cookie.split(";"),n=0;n<a.length;n++){for(var r=a[n];" "===r.charAt(0);)r=r.substring(1);if(0===r.indexOf(t))return r.substring(t.length,r.length)}return""}("lastfetch");return""===t||+e-+t>0}var T=function(e){return r.a.createElement("div",{className:"sortOrder"},r.a.createElement("ul",null,r.a.createElement("li",{onClick:function(){e.updateSortOrder("np")},className:"np"===e.sortOrder?"active":void 0},"Now Playing"),r.a.createElement("li",{onClick:function(){e.updateSortOrder("p")},className:"p"===e.sortOrder?"active":void 0},"Popular"),r.a.createElement("li",{onClick:function(){e.updateSortOrder("tr")},className:"tr"===e.sortOrder?"active":void 0},"Top Rated"),r.a.createElement("li",{onClick:function(){e.updateSortOrder("u")},className:"u"===e.sortOrder?"active":void 0},"Upcoming")))},M=a(4),C=function(e){var t=e.movie,a=Object(n.useState)(!1),c=Object(M.a)(a,2),l=c[0],o=c[1];Object(n.useEffect)((function(){var e=S(t.id);o(e)}),[t.id]);return r.a.createElement("div",{className:"interactive-btn like-btn"},r.a.createElement("img",{src:l?"./images/like.png":"./images/unlike.png",alt:"heart",onClick:function(){l?(_(t.id),o(!1)):(O(t),o(!0))}}))},J=function(e){var t=e.movie,a=Object(n.useState)(!1),c=Object(M.a)(a,2),l=c[0],o=c[1];Object(n.useEffect)((function(){var e=S(t.id,"watchlater");o(e)}),[t.id]);return r.a.createElement("div",{className:"interactive-btn",onClick:function(){l?(_(t.id,"watchlater"),o(!1)):(O(t,"watchlater"),o(!0))}},r.a.createElement("img",{src:l?"./images/remove.png":"./images/add.png",alt:"watchlist"}))},z=function(e){return r.a.createElement("div",{key:e.movie.id,className:"poster"},r.a.createElement("div",{className:"posterimg"},r.a.createElement(o.b,{to:"/movie/"+e.movie.id},e.movie.poster_path.includes("null")?r.a.createElement("h2",{id:"no-poster"},e.movie.title):r.a.createElement("img",{src:e.movie.poster_path,alt:e.movie.title}))),r.a.createElement("div",{className:"poster-btns"},r.a.createElement(C,{movie:e.movie}),r.a.createElement(J,{movie:e.movie})))},U=a(23),B=function(e){Object(v.a)(a,e);var t=Object(g.a)(a);function a(){var e;Object(p.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={sortOrder:"np",movies:null,npMovies:null,pMovies:null,trMovies:null,uMovies:null},e.componentDidMount=function(){e.loadMovies()},e.loadMovies=Object(u.a)(m.a.mark((function t(){var a,n,r,c,l;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=[],n=[],r=[],c=[],l=localStorage.getItem("sortOrder"),!I()){t.next=30;break}return console.log("fetching..."),t.t0=Promise,t.next=10,w("np",1);case 10:return t.t1=a=t.sent,t.next=13,w("p",1);case 13:return t.t2=n=t.sent,t.next=16,w("tr",1);case 16:return t.t3=r=t.sent,t.next=19,w("u",1);case 19:return t.t4=c=t.sent,t.t5=[t.t1,t.t2,t.t3,t.t4],t.next=23,t.t0.all.call(t.t0,t.t5).catch((function(e){console.log(e)}));case 23:x(a),x(n,"p"),x(r,"tr"),x(c,"u"),j(),t.next=35;break;case 30:console.log("local storage..."),a=JSON.parse(localStorage.getItem("np")),n=JSON.parse(localStorage.getItem("p")),r=JSON.parse(localStorage.getItem("tr")),c=JSON.parse(localStorage.getItem("u"));case 35:l&&e.setState({sortOrder:l},(function(){e.handleSortUpdate(l)})),e.setState({movies:a,npMovies:a,pMovies:n,trMovies:r,uMovies:c});case 37:case"end":return t.stop()}}),t)}))),e.handleSortUpdate=function(t){switch(t){case"p":e.setState({movies:e.state.pMovies});break;case"tr":e.setState({movies:e.state.trMovies});break;case"u":e.setState({movies:e.state.uMovies});break;default:e.setState({movies:e.state.npMovies})}localStorage.setItem("sortOrder",t),e.setState({sortOrder:t})},e.fetchMovies=Object(u.a)(m.a.mark((function t(){var a,n;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.state.movies.length/20+1,t.next=3,w(e.state.sortOrder,a);case 3:n=t.sent,e.setState({movies:e.state.movies.concat(n)});case 5:case"end":return t.stop()}}),t)}))),e}return Object(d.a)(a,[{key:"render",value:function(){return null===this.state.movies?"":r.a.createElement("div",{className:"movie-grid-wrapper"},r.a.createElement(T,{updateSortOrder:this.handleSortUpdate,sortOrder:this.state.sortOrder}),r.a.createElement(U.a,{className:"movie-gallery",dataLength:this.state.movies.length,next:this.fetchMovies,hasMore:!0,loader:r.a.createElement("h3",null,"Loading...")},this.state.movies.map((function(e){return r.a.createElement(z,{key:e.id,movie:e})}))))}}]),a}(n.Component),D=a(24),L=a.n(D),A=function(e){var t=e.id,a=Object(n.useState)(!1),c=Object(M.a)(a,2),l=c[0],o=c[1];return r.a.createElement("div",{className:"trailer-container"},r.a.createElement(L.a,{channel:"youtube",isOpen:l,videoId:t,onClose:function(){return o(!1)}}),r.a.createElement("div",{className:"trailer-btn",onClick:function(e){o(!0)}},r.a.createElement("img",{src:"./images/play-button.png",alt:"play button"}),r.a.createElement("h3",null,"Play Trailer")))},F=function(){var e=Object(i.f)().id,t=Object(n.useState)({}),a=Object(M.a)(t,2),c=a[0],l=a[1],o=Object(n.useState)([]),s=Object(M.a)(o,2),p=s[0],d=s[1],v=Object(n.useState)([]),g=Object(M.a)(v,2),h=g[0],f=g[1];return Object(n.useEffect)((function(){(function(){var t=Object(u.a)(m.a.mark((function t(){var a,n;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,E(e).catch((function(e){console.log(e)}));case 2:a=t.sent,n=a.genres.map((function(e){return e.name})),f(a.similar_movies),d(n),l(a);case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[e]),r.a.createElement("div",{className:"movie"},r.a.createElement("div",{className:"backdrop-wrapper"},c.backdrop_path&&c.backdrop_path.includes("null")?r.a.createElement("img",{src:"./images/no-backdrop.jpg",alt:"no backdrop"}):r.a.createElement("img",{src:c.backdrop_path,alt:c.title})),r.a.createElement("div",{className:"poster-wrapper"},c.poster_path&&c.poster_path.includes("null")?r.a.createElement("div",{className:"no-poster"},r.a.createElement("h3",null,c.title)):r.a.createElement("img",{src:c.poster_path,alt:c.title}),c.trailer_id&&r.a.createElement("div",{className:"trailer-section"},r.a.createElement(A,{id:c.trailer_id}))),r.a.createElement("div",{className:"movie-info"},r.a.createElement("div",{className:"movie-header"},r.a.createElement("div",{className:"movie-title"},r.a.createElement("h2",null,c.title)),r.a.createElement("div",{className:"movie-rating"},r.a.createElement("h2",{id:"rating"},parseFloat(c.rating).toFixed(1)))),r.a.createElement("div",{className:"movie-details"},r.a.createElement("p",null,c.language,"\xa0\xa0|\xa0\xa0",c.runtime," ","min\xa0\xa0|\xa0\xa0",p.join(", "),"\xa0\xa0|\xa0\xa0",c.release_date)),r.a.createElement("div",{className:"movie-overview"},c.tagline&&r.a.createElement("p",{className:"movie-tagline"},c.tagline),r.a.createElement("p",{className:"overview-text"},c.overview))),r.a.createElement("div",{className:"movie-btns"},r.a.createElement(C,{movie:c}),r.a.createElement(J,{movie:c})),h.length>0&&r.a.createElement("h2",{id:"similar-movie-heading"},"Similar Movies"),h.length>0?r.a.createElement("div",{className:"movie-gallery similar-movies"},h.map((function(e){return r.a.createElement(z,{key:e.id,movie:e})}))):"")},W=(a(45),function(e){return r.a.createElement(o.b,{to:"/movie/"+e.movie.id,className:"search-result"},r.a.createElement("div",{className:"result-poster"},r.a.createElement("img",{src:e.movie.poster_path,alt:e.movie.title})),r.a.createElement("div",{className:"result-details"},r.a.createElement("div",{className:"result-title"},r.a.createElement("h2",null,e.movie.title)),r.a.createElement("div",{className:"result-year"},r.a.createElement("h2",null,e.movie.release_date?e.movie.release_date.substring(0,e.movie.release_date.indexOf("-")):"(N/A)"))))}),P=function(){var e=Object(n.useState)(null),t=Object(M.a)(e,2),a=t[0],c=t[1],l=function(){var e=Object(u.a)(m.a.mark((function e(t){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.getElementById("main").style.opacity=.3,e.next=4,N(t.target.value).catch((function(e){console.log(e)}));case 4:a=e.sent,c(a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"search-container"},r.a.createElement("div",{className:"searchbar",onBlur:function(e){document.getElementById("main").style.opacity=1,e.target.value="",setTimeout((function(){c(null)}),100)}},r.a.createElement("input",{type:"text",placeholder:"Search movies...",onChange:l})),a&&r.a.createElement("div",{className:"search-results"},a.map((function(e){return r.a.createElement(W,{key:e.id,movie:e})}))))},Y=function(){var e=function(e){document.body.classList.toggle("show")};return window.onload=function(){var e=window.pageYOffset;window.onscroll=function(){var t=window.pageYOffset;document.getElementById("header").style.top=e>t?"0":"-50px",e=t;var a=document.getElementById("scroll-to-top-btn");document.body.scrollTop>600||document.documentElement.scrollTop>600?a.style.display="block":a.style.display="none"},document.getElementById("main").addEventListener("click",(function(){document.body.classList.contains("show")&&document.body.classList.remove("show")}))},r.a.createElement("header",{id:"header"},r.a.createElement("div",{className:"logo"},r.a.createElement(o.c,{to:"/"},"WT")),r.a.createElement(P,null),r.a.createElement("div",{className:"menu-btn",onClick:e},r.a.createElement("img",{src:"./images/menu.png",alt:"burger menu icon"})),r.a.createElement("nav",{className:"navbar"},r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(o.c,{to:"/favourites",onClick:e},"Favourites")),r.a.createElement("li",null,r.a.createElement(o.c,{to:"/watchlist",onClick:e},"Watchlist")),r.a.createElement("li",null,r.a.createElement(o.c,{to:"/about",onClick:e},"About")))))},R=function(){return r.a.createElement("div",{className:"about-us-page"},r.a.createElement("div",{className:"about-us-content"},r.a.createElement("h2",null,"What's That?"),r.a.createElement("p",null,"A React web application to browse and discover new movies. Use it to save your favourites and to compile a never-ending backlog!")),r.a.createElement("div",{className:"credits"},r.a.createElement("p",null,"This product uses the TMDb API but is not endorsed or certified by TMDb."),r.a.createElement("img",{src:"./images/tmdb-logo.svg",alt:"tmdb logo"})),r.a.createElement("div",{className:"about-us-bg"}))},q=function(){var e=Object(n.useState)(null),t=Object(M.a)(e,2),a=t[0],c=t[1];return Object(n.useEffect)((function(){var e=JSON.parse(localStorage.getItem("favourites"));e&&c(e)}),[]),r.a.createElement("div",{className:"list-page"},null===a?r.a.createElement("div",{className:"empty-list"},r.a.createElement(o.b,{to:"/"},r.a.createElement("h2",null,"You have no favourites. Click me to go add some!"))):r.a.createElement("div",{className:"movie-grid-wrapper"},r.a.createElement("h2",{className:"list-title"},"Favourites"),r.a.createElement("div",{className:"movie-gallery"},a.map((function(e){return r.a.createElement(z,{key:e.id,movie:e})})))),null===a&&r.a.createElement("div",{className:"empty-list-bg"}))},$=function(){var e=Object(n.useState)(null),t=Object(M.a)(e,2),a=t[0],c=t[1];return Object(n.useEffect)((function(){var e=JSON.parse(localStorage.getItem("watchlater"));e&&c(e)}),[]),r.a.createElement("div",{className:"list-page"},null===a?r.a.createElement("div",{className:"empty-list"},r.a.createElement(o.b,{to:"/"},r.a.createElement("h2",null,"Your watchlist is empty. Click me to go add some!"))):r.a.createElement("div",{className:"movie-grid-wrapper"},r.a.createElement("h2",{className:"list-title"},"Watchlist"),r.a.createElement("div",{className:"movie-gallery"},a.map((function(e){return r.a.createElement(z,{key:e.id,movie:e})})))),null===a&&r.a.createElement("div",{className:"empty-list-bg"}))};var G=Object(i.g)((function(e){var t=e.history,a=e.children;return Object(n.useEffect)((function(){var e=t.listen((function(){window.scrollTo(0,0)}));return function(){e()}}),[]),r.a.createElement(n.Fragment,null,a)})),H=function(){return r.a.createElement("footer",null,r.a.createElement("p",null,"\xa9 2020 Tin Lau - For educational purposes only"))},K=function(){return r.a.createElement("div",{className:"back-to-top-btn",onClick:function(){document.body.scrollTop=0,document.documentElement.scrollTop=0},id:"scroll-to-top-btn"},r.a.createElement("div",{className:"back-to-top-content"},r.a.createElement("h3",null,"Top"),r.a.createElement("img",{src:"./images/up-arrow.png",alt:"back to top button"})))},Q=function(){return r.a.createElement("div",{className:"page-not-found"},r.a.createElement("h2",null,"404"),r.a.createElement("p",null,"This is not the page you're looking for"),r.a.createElement("div",{className:"page-not-found-bg"}))};var V=function(){return r.a.createElement(o.a,{basename:"/movie-app"},r.a.createElement("div",{className:"wrapper"},r.a.createElement(Y,null),r.a.createElement("main",{id:"main"},r.a.createElement(G,null,r.a.createElement(i.c,null,r.a.createElement(i.a,{path:"/",exact:!0},r.a.createElement(B,null)),r.a.createElement(i.a,{path:"/movie/:id",exact:!0},r.a.createElement(F,null)),r.a.createElement(i.a,{path:"/about",exact:!0},r.a.createElement(R,null)),r.a.createElement(i.a,{path:"/favourites",exact:!0},r.a.createElement(q,null)),r.a.createElement(i.a,{path:"/watchlist",exact:!0},r.a.createElement($,null)),r.a.createElement(i.a,null,r.a.createElement(Q,null))))),r.a.createElement(K,null),r.a.createElement(H,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(V,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[27,1,2]]]);
//# sourceMappingURL=main.cb1a1d12.chunk.js.map